<svg ng-attr-width="{{$ctrl.width}}" ng-attr-height="{{$ctrl.height + 30}}">
    <g ng-repeat="row in $ctrl.rows">
        <line stroke="grey"
                stroke-width="1"
                x1="70"
                ng-attr-y1="{{$ctrl.pixel(($ctrl.height - 25.5) - row * $ctrl.scale())}}"
                x2="1000"
                ng-attr-y2="{{$ctrl.pixel(($ctrl.height - 25.5) - row * $ctrl.scale())}}" />
        <text font-size="11" font-family="Arial" text-anchor="end" ng-attr-transform="translate(67, {{$ctrl.height - 22.5 - row * $ctrl.scale()}})">{{row | number:$ctrl.decimals}} {{$ctrl.suffix}}</text>
    </g>
    <g>
        <rect width="10" ng-attr-height="10"
            ng-if="$ctrl.showLabel1()"
            ng-attr-y="{{$ctrl.height + 10}}"
            ng-attr-x="100"
            fill="{{$ctrl.color1}}" />
        
        <text font-size="11" font-family="Arial"
            ng-if="$ctrl.showLabel1()"
            text-anchor="left"
            ng-attr-transform="translate(115, {{$ctrl.height + 19}})">{{$ctrl.label1}}</text>

        <rect width="10" ng-attr-height="10" 
            ng-if="$ctrl.showLabel2()"
            ng-attr-y="{{$ctrl.height + 10}}"
            ng-attr-x="{{100 + $ctrl.offsetLabel2()}}"
            fill="{{$ctrl.color2}}" />
        
        <text font-size="11" font-family="Arial"
            ng-if="$ctrl.showLabel2()"
            text-anchor="left"
            ng-attr-transform="translate({{115 + $ctrl.offsetLabel2()}}, {{$ctrl.height + 19}})">{{$ctrl.label2}}</text>

        <rect width="10" ng-attr-height="10" 
            ng-if="$ctrl.showLabel3()"
            ng-attr-y="{{$ctrl.height + 10}}"
            ng-attr-x="{{100 + $ctrl.offsetLabel3()}}"
            fill="{{$ctrl.color3}}" />
        
        <text font-size="11" font-family="Arial"
            ng-if="$ctrl.showLabel3()"
            text-anchor="left"
            ng-attr-transform="translate({{115 + $ctrl.offsetLabel3()}}, {{$ctrl.height + 19}})">{{$ctrl.label3}}</text>

        <rect width="10" ng-attr-height="10" 
            ng-if="$ctrl.showLabel4()"
            ng-attr-y="{{$ctrl.height + 10}}"
            ng-attr-x="{{100 + $ctrl.offsetLabel4()}}"
            fill="{{$ctrl.color4}}" />
        
        <text font-size="11" font-family="Arial"
            ng-if="$ctrl.showLabel4()"
            text-anchor="left"
            ng-attr-transform="translate({{115 + $ctrl.offsetLabel2()}}, {{$ctrl.height + 19}})">{{$ctrl.label4}}</text>
    </g>
    <g ng-repeat="data in $ctrl.data">
        <rect ng-if="data.value4 !== undefined"
            ng-mouseenter="data.visibility4 = 'visible'"
            ng-mouseleave="data.visibility4 = 'hidden'"
            width="9"
            ng-attr-height="{{(data.value1 + data.value2 + data.value3 + data.value4) * $ctrl.scale()}}"
            ng-attr-y="{{($ctrl.height - 25) - (data.value1 + data.value2 + data.value3 + data.value4) * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 80)}}"
            fill="{{$ctrl.color4}}" />
        <rect ng-if="data.value3 !== undefined"
            ng-mouseenter="data.visibility3 = 'visible'"
            ng-mouseleave="data.visibility3 = 'hidden'"
            width="9"
            ng-attr-height="{{(data.value1 + data.value2 + data.value3) * $ctrl.scale()}}"
            ng-attr-y="{{($ctrl.height - 25) - (data.value1 + data.value2 + data.value3) * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 80)}}"
            fill="{{$ctrl.color3}}" />
        <rect ng-if="data.value2 !== undefined"
            ng-mouseenter="data.visibility2 = 'visible'"
            ng-mouseleave="data.visibility2 = 'hidden'"
            width="9"
            ng-attr-height="{{(data.value1 + data.value2) * $ctrl.scale()}}"
            ng-attr-y="{{($ctrl.height - 25) - (data.value1 + data.value2) * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 80)}}"
            fill="{{$ctrl.color2}}" />
        <rect width="9"
            ng-mouseenter="data.visibility1 = 'visible'"
            ng-mouseleave="data.visibility1 = 'hidden'"
            ng-attr-height="{{data.value1 * $ctrl.scale()}}" 
            ng-attr-y="{{($ctrl.height - 25) - data.value1 * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 80)}}"
            fill="{{$ctrl.color1}}" />
    </g>
    <g ng-repeat="data in $ctrl.data">
        <rect ng-attr-visibility="{{data.visibility4}}"
            width="40"
            height="15" 
            ng-attr-y="{{($ctrl.height - 46) - (data.value1 + data.value2 + data.value3 + data.value4) * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 60)}}"
            fill="#000" />
        <text ng-attr-visibility="{{data.visibility4}}"
            fill="#FFFFFF"
            text-anchor="middle"
            font-size="11"
            font-family="Arial" 
            ng-attr-y="{{($ctrl.height - 35) - (data.value1 + data.value2 + data.value3 + data.value4) * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 84)}}">{{data.value3}}</text>

        <rect ng-attr-visibility="{{data.visibility3}}"
            width="40"
            height="15" 
            ng-attr-y="{{($ctrl.height - 46) - (data.value1 + data.value2 + data.value3) * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 60)}}"
            fill="#000" />
        <text ng-attr-visibility="{{data.visibility3}}"
            fill="#FFFFFF"
            text-anchor="middle"
            font-size="11"
            font-family="Arial" 
            ng-attr-y="{{($ctrl.height - 35) - (data.value1 + data.value2 + data.value3) * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 84)}}">{{data.value3}}</text>

        <rect ng-attr-visibility="{{data.visibility2}}"
            width="50"
            height="15" 
            ng-attr-y="{{($ctrl.height - 46) - (data.value1 + data.value2) * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 60)}}"
            fill="#000" />
        <text ng-attr-visibility="{{data.visibility2}}"
            fill="#FFFFFF"
            text-anchor="middle"
            font-size="11"
            font-family="Arial" 
            ng-attr-y="{{($ctrl.height - 35) - (data.value1 + data.value2) * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 84)}}">{{data.value2}}</text>

        <rect ng-attr-visibility="{{data.visibility1}}"
            width="50"
            height="15"
            ng-attr-y="{{($ctrl.height - 46) - data.value1 * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 60)}}"
            fill="#000" />
        <text ng-attr-visibility="{{data.visibility1}}"
            fill="#FFFFFF"
            z
            text-anchor="middle"
            font-size="11"
            font-family="Arial" 
            ng-attr-y="{{($ctrl.height - 35) - data.value1 * $ctrl.scale()}}"
            ng-attr-x="{{$ctrl.step($index, 84)}}">{{data.value1}}</text>
        
        <text font-size="11"
            font-family="Arial"
            text-anchor="middle"
            ng-attr-transform="translate({{$ctrl.step($index, 84)}},{{$ctrl.height - 10}})">{{data.label}}</text>
    </g>
</svg>
